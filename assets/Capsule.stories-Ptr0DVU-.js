import{p as Z,s as ne,r as ie,i as ae,a as oe,t as ce}from"./props-CDwtXEPn.js";import{p as Y,a as Q,f as re,g as pe,n as le,s as q,d as de}from"./index-client-0IVJ1HVs.js";import{M as J,v as K,V as f,x as G,y as ue,w as ye,k as he,c as me,d as be,C as fe,E as ve,S as xe,H as Se}from"./create-runtime-stories-D2yFG5at.js";import{F as ke}from"./FreeCamera-B8cQlsl3.js";import"./iframe-2opK77xr.js";import"../sb-preview/runtime.js";import"./index-D-8MO0q_.js";import"./index-BHYIh-Xd.js";import"./_commonjsHelpers-Cpj98o6Y.js";function W(e={subdivisions:2,tessellation:16,height:1,radius:.25,capSubdivisions:6}){const l=Math.max(e.subdivisions?e.subdivisions:2,1)|0,v=Math.max(e.tessellation?e.tessellation:16,3)|0,b=Math.max(e.height?e.height:1,0),c=Math.max(e.radius?e.radius:.25,0),w=Math.max(e.capSubdivisions?e.capSubdivisions:6,1)|0,x=v,g=l,o=Math.max(e.radiusTop?e.radiusTop:c,0),r=Math.max(e.radiusBottom?e.radiusBottom:c,0),B=b-(o+r),E=0,_=2*Math.PI,C=Math.max(e.topCapSubdivisions?e.topCapSubdivisions:w,1),z=Math.max(e.bottomCapSubdivisions?e.bottomCapSubdivisions:w,1),h=Math.acos((r-o)/b);let u=[];const p=[],M=[],P=[];let D=0;const T=[],H=B*.5,O=Math.PI*.5;let n,s;const y=f.Zero(),i=f.Zero(),I=Math.cos(h),j=Math.sin(h),F=new G(o*j,H+o*I).subtract(new G(r*j,-H+r*I)).length(),U=o*h+F+r*(O-h);let L=0;for(s=0;s<=C;s++){const d=[],a=O-h*(s/C);L+=o*h/C;const t=Math.cos(a),m=Math.sin(a),S=t*o;for(n=0;n<=x;n++){const k=n/x,$=k*_+E,R=Math.sin($),V=Math.cos($);i.x=S*R,i.y=H+m*o,i.z=S*V,p.push(i.x,i.y,i.z),y.set(t*R,m,t*V),M.push(y.x,y.y,y.z),P.push(k,1-L/U),d.push(D),D++}T.push(d)}const X=b-o-r+I*o-I*r,se=j*(r-o)/X;for(s=1;s<=g;s++){const d=[];L+=F/g;const a=j*(s*(r-o)/g+o);for(n=0;n<=x;n++){const t=n/x,m=t*_+E,S=Math.sin(m),k=Math.cos(m);i.x=a*S,i.y=H+I*o-s*X/g,i.z=a*k,p.push(i.x,i.y,i.z),y.set(S,se,k).normalize(),M.push(y.x,y.y,y.z),P.push(t,1-L/U),d.push(D),D++}T.push(d)}for(s=1;s<=z;s++){const d=[],a=O-h-(Math.PI-h)*(s/z);L+=r*h/z;const t=Math.cos(a),m=Math.sin(a),S=t*r;for(n=0;n<=x;n++){const k=n/x,$=k*_+E,R=Math.sin($),V=Math.cos($);i.x=S*R,i.y=-H+m*r,i.z=S*V,p.push(i.x,i.y,i.z),y.set(t*R,m,t*V),M.push(y.x,y.y,y.z),P.push(k,1-L/U),d.push(D),D++}T.push(d)}for(n=0;n<x;n++)for(s=0;s<C+g+z;s++){const d=T[s][n],a=T[s+1][n],t=T[s+1][n+1],m=T[s][n+1];u.push(d),u.push(a),u.push(m),u.push(a),u.push(t),u.push(m)}if(u=u.reverse(),e.orientation&&!e.orientation.equals(f.Up())){const d=new ue;e.orientation.clone().scale(Math.PI*.5).cross(f.Up()).toQuaternion().toRotationMatrix(d);const a=f.Zero();for(let t=0;t<p.length;t+=3)a.set(p[t],p[t+1],p[t+2]),f.TransformCoordinatesToRef(a.clone(),d,a),p[t]=a.x,p[t+1]=a.y,p[t+2]=a.z}const A=new K;return A.positions=p,A.normals=M,A.uvs=P,A.indices=u,A}function ee(e,l={orientation:f.Up(),subdivisions:2,tessellation:16,height:1,radius:.25,capSubdivisions:6,updatable:!1},v=null){const b=new J(e,v);return W(l).applyToMesh(b,l.updatable),b}J.CreateCapsule=(e,l,v)=>ee(e,l,v);K.CreateCapsule=W;function N(e,l){Y(l,!0);let v=Z(l,"mesh",15),b=Z(l,"physicsShape",19,()=>ye.CAPSULE),c=ie(l,["$$slots","$$events","$$legacy","mesh","physicsShape"]);he(e,ne({createMeshFunction:ee,get physicsShape(){return b()}},()=>c,{get mesh(){return v()},set mesh(w){v(w)}})),Q()}N.__docgen={data:[{name:"options",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"ICreateCapsuleOptions"},static:!1,readonly:!1},{name:"scene",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"Scene"},static:!1,readonly:!1},{name:"children",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"Snippet<[]>"},static:!1,readonly:!1},{name:"mesh",visibility:"public",description:"if you want to use a mesh api, bind it",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"Mesh"},static:!1,readonly:!1,defaultValue:"..."},{name:"physics",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1},{name:"physicsShape",visibility:"public",keywords:[],kind:"let",type:{kind:"union",type:[{kind:"const",type:"number",value:0,text:"PhysicsShapeType.SPHERE"},{kind:"const",type:"number",value:1,text:"PhysicsShapeType.CAPSULE"},{kind:"const",type:"number",value:2,text:"PhysicsShapeType.CYLINDER"},{kind:"const",type:"number",value:3,text:"PhysicsShapeType.BOX"},{kind:"const",type:"number",value:4,text:"PhysicsShapeType.CONVEX_HULL"},{kind:"const",type:"number",value:5,text:"PhysicsShapeType.CONTAINER"},{kind:"const",type:"number",value:6,text:"PhysicsShapeType.MESH"},{kind:"const",type:"number",value:7,text:"PhysicsShapeType.HEIGHTFIELD"},{kind:"type",type:"object",text:"PhysicsShape"}],text:"PhysicsShapeType.SPHERE | PhysicsShapeType.CAPSULE | PhysicsShapeType.CYLINDER | PhysicsShapeType.BOX | PhysicsShapeType.CONVEX_HULL | PhysicsShapeType.CONTAINER | PhysicsShapeType.MESH | PhysicsShapeType.HEIGHTFIELD | PhysicsShape"},static:!1,readonly:!1,defaultValue:"PhysicsShapeType.CAPSULE"},{name:"physicsOptions",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"PhysicsAggregateParameters"},static:!1,readonly:!1},{name:"position",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"rotation",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"scaling",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"force",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"impulse",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"onCollision",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"(eventData: IPhysicsCollisionEvent, eventState: EventState) => void"},static:!1,readonly:!1},{name:"onCollisionOnce",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"(eventData: IPhysicsCollisionEvent, eventState: EventState) => void"},static:!1,readonly:!1}],name:"Capsule.svelte"};const ge={title:"mesh/Capsule",tags:["autodocs"],component:N},{Story:Ce}=be();var Me=ce("<!> <!> <!>",1);function te(e,l){Y(l,!1),ae(),Ce(e,{name:"Docs",args:{options:{orientation:{x:0,y:0,z:0},subdivisions:void 0,tessellation:void 0,height:4,radius:1,capSubdivisions:void 0,radiusTop:void 0,radiusBottom:void 0,topCapSubdivisions:void 0,bottomCapSubdivisions:void 0,updatable:void 0},position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scaling:{x:1,y:1,z:1}},children:(b,c=le)=>{fe(b,{style:"width: 100%;",children:(w,x)=>{ve(w,{children:(g,o)=>{xe(g,{children:(r,B)=>{var E=Me(),_=re(E);ke(_,{position:new f(0,5,-10)});var C=q(_,2);Se(C,{direction:new f(0,1,0),intensity:.7});var z=q(C,2),h=de(()=>{var u,p,M,P;return{...c().options,orientation:(u=c().options)!=null&&u.orientation?new f((p=c().options)==null?void 0:p.orientation.x,(M=c().options)==null?void 0:M.orientation.y,(P=c().options)==null?void 0:P.orientation.z):void 0}});N(z,{get options(){return pe(h)},get position(){return c().position},get rotation(){return c().rotation},get scaling(){return c().scaling}}),oe(r,E)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0},parameters:{__svelteCsf:{rawCode:`<Canvas style="width: 100%;">
  <Engine>
    <Scene>
      <FreeCamera position={new Vector3(0, 5, -10)} />
      <HemisphericLight direction={new Vector3(0, 1, 0)} intensity={0.7} />
      <Capsule
        options={{
          ...args.options,
          orientation: args.options?.orientation
            ? new Vector3(
                args.options?.orientation.x,
                args.options?.orientation.y,
                args.options?.orientation.z
              )
            : undefined
        }}
        position={args.position}
        rotation={args.rotation}
        scaling={args.scaling}
      />
    </Scene>
  </Engine>
</Canvas>`}}}),Q()}te.__docgen={version:3,name:"Capsule.stories.svelte",data:[],computed:[],methods:[],components:[],description:null,keywords:[],events:[],slots:[],refs:[]};const Pe=me(te,ge),Ae=["Docs"],$e=Pe.Docs;export{$e as Docs,Ae as __namedExportsOrder,ge as default};
