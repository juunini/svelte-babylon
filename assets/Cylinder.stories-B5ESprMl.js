import{p as he,s as be,r as xe,i as ge,a as Ve,t as we}from"./props-D_CwaEcb.js";import{p as Ce,a as ze,f as ke,b as Ue,n as ve,c as re,d as _e}from"./index-client-a4XWVA08.js";import{f as I,M as A,r as $e,j as ce,d as Z,V as _,A as Se,c as ae,k as De,l as Ae,m as Me,n as Fe,o as Le,p as Pe,F as Ee,H as Oe}from"./create-runtime-stories-BWJ8FmbH.js";import"./iframe-vcUCgR62.js";import"../sb-preview/runtime.js";import"./index-D-8MO0q_.js";import"./index-BHYIh-Xd.js";import"./_commonjsHelpers-Cpj98o6Y.js";function le(s){const r=s.height||2;let f=s.diameterTop===0?0:s.diameterTop||s.diameter||1,c=s.diameterBottom===0?0:s.diameterBottom||s.diameter||1;f=f||1e-5,c=c||1e-5;const t=(s.tessellation||24)|0,x=(s.subdivisions||1)|0,p=!!s.hasRings,w=!!s.enclose,M=s.cap===0?0:s.cap||A.CAP_ALL,$=s.arc&&(s.arc<=0||s.arc>1)?1:s.arc||1,K=s.sideOrientation===0?0:s.sideOrientation||I.DEFAULTSIDE,o=s.faceUV||new Array(3),n=s.faceColors,R=$!==1&&w?2:0,q=p?x:1,L=2+(1+R)*q;let m;for(m=0;m<L;m++)n&&n[m]===void 0&&(n[m]=new ce(1,1,1,1));for(m=0;m<L;m++)o&&o[m]===void 0&&(o[m]=new Z(0,0,1,1));const a=[],i=[],h=[],S=[],F=[],ue=Math.PI*2*$/t;let H,P,Y;const fe=(c-f)/2/r,y=_.Zero(),l=_.Zero(),B=_.Zero(),Q=_.Zero(),d=_.Zero(),W=Se.Y;let u,b,j,X=1,e=1,N=0,C=0;for(u=0;u<=x;u++)for(P=u/x,Y=(P*(f-c)+c)/2,X=p&&u!==0&&u!==x?2:1,j=0;j<X;j++){for(p&&(e+=j),w&&(e+=2*j),b=0;b<=t;b++)H=b*ue,y.x=Math.cos(-H)*Y,y.y=-r/2+P*r,y.z=Math.sin(-H)*Y,f===0&&u===x?(l.x=h[h.length-(t+1)*3],l.y=h[h.length-(t+1)*3+1],l.z=h[h.length-(t+1)*3+2]):(l.x=y.x,l.z=y.z,l.y=Math.sqrt(l.x*l.x+l.z*l.z)*fe,l.normalize()),b===0&&(B.copyFrom(y),Q.copyFrom(l)),i.push(y.x,y.y,y.z),h.push(l.x,l.y,l.z),p?C=N!==e?o[e].y:o[e].w:C=o[e].y+(o[e].w-o[e].y)*P,S.push(o[e].x+(o[e].z-o[e].x)*b/t,C),n&&F.push(n[e].r,n[e].g,n[e].b,n[e].a);$!==1&&w&&(i.push(y.x,y.y,y.z),i.push(0,y.y,0),i.push(0,y.y,0),i.push(B.x,B.y,B.z),_.CrossToRef(W,l,d),d.normalize(),h.push(d.x,d.y,d.z,d.x,d.y,d.z),_.CrossToRef(Q,W,d),d.normalize(),h.push(d.x,d.y,d.z,d.x,d.y,d.z),p?C=N!==e?o[e+1].y:o[e+1].w:C=o[e+1].y+(o[e+1].w-o[e+1].y)*P,S.push(o[e+1].x,C),S.push(o[e+1].z,C),p?C=N!==e?o[e+2].y:o[e+2].w:C=o[e+2].y+(o[e+2].w-o[e+2].y)*P,S.push(o[e+2].x,C),S.push(o[e+2].z,C),n&&(F.push(n[e+1].r,n[e+1].g,n[e+1].b,n[e+1].a),F.push(n[e+1].r,n[e+1].g,n[e+1].b,n[e+1].a),F.push(n[e+2].r,n[e+2].g,n[e+2].b,n[e+2].a),F.push(n[e+2].r,n[e+2].g,n[e+2].b,n[e+2].a))),N!==e&&(N=e)}const T=$!==1&&w?t+4:t;for(u=0,e=0;e<x;e++){let g=0,z=0,k=0,D=0;for(b=0;b<t;b++)g=u*(T+1)+b,z=(u+1)*(T+1)+b,k=u*(T+1)+(b+1),D=(u+1)*(T+1)+(b+1),a.push(g,z,k),a.push(D,k,z);$!==1&&w&&(a.push(g+2,z+2,k+2),a.push(D+2,k+2,z+2),a.push(g+4,z+4,k+4),a.push(D+4,k+4,z+4)),u=p?u+2:u+1}const ee=g=>{const z=g?f/2:c/2;if(z===0)return;let k,D,U;const V=g?o[L-1]:o[0];let v=null;n&&(v=g?n[L-1]:n[0]);const O=i.length/3,te=g?r/2:-r/2,G=new _(0,te,0);i.push(G.x,G.y,G.z),h.push(0,g?1:-1,0);const ye=V.y+(V.w-V.y)*.5;S.push(V.x+(V.z-V.x)*.5,ye),v&&F.push(v.r,v.g,v.b,v.a);const ne=new ae(.5,.5);for(U=0;U<=t;U++){k=Math.PI*2*U*$/t;const se=Math.cos(-k),oe=Math.sin(-k);D=new _(se*z,te,oe*z);const ie=new ae(se*ne.x+.5,oe*ne.y+.5);i.push(D.x,D.y,D.z),h.push(0,g?1:-1,0);const me=V.y+(V.w-V.y)*ie.y;S.push(V.x+(V.z-V.x)*ie.x,me),v&&F.push(v.r,v.g,v.b,v.a)}for(U=0;U<t;U++)g?(a.push(O),a.push(O+(U+2)),a.push(O+(U+1))):(a.push(O),a.push(O+(U+1)),a.push(O+(U+2)))};(M===A.CAP_START||M===A.CAP_ALL)&&ee(!1),(M===A.CAP_END||M===A.CAP_ALL)&&ee(!0),I._ComputeSides(K,i,a,h,S,s.frontUVs,s.backUVs);const E=new I;return E.indices=a,E.positions=i,E.normals=h,E.uvs=S,n&&(E.colors=F),E}function de(s,r={},f){const c=new A(s,f);return r.sideOrientation=A._GetDefaultSideOrientation(r.sideOrientation),c._originalBuilderSideOrientation=r.sideOrientation,le(r).applyToMesh(c,r.updatable),c}I.CreateCylinder=le;A.CreateCylinder=(s,r,f,c,t,x,p,w,M)=>((p===void 0||!(p instanceof $e))&&(p!==void 0&&(M=w||A.DEFAULTSIDE,w=p),p=x,x=1),de(s,{height:r,diameterTop:f,diameterBottom:c,tessellation:t,subdivisions:x,sideOrientation:M,updatable:w},p));function J(s,r){let f=he(r,"mesh",15),c=xe(r,["$$slots","$$events","$$legacy","mesh"]);De(s,be({createMeshFunction:de},()=>c,{get mesh(){return f()},set mesh(t){f(t)}}))}J.__docgen={data:[{name:"options",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ arc?: number | undefined; backUVs?: Vector4 | undefined; cap?: number | undefined; diameter?: number | undefined; diameterBottom?: number | undefined; diameterTop?: number | undefined; ... 9 more ...; updatable?: boolean | undefined; }"},static:!1,readonly:!1},{name:"scene",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"Scene"},static:!1,readonly:!1},{name:"children",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"Snippet<[]>"},static:!1,readonly:!1},{name:"mesh",visibility:"public",description:"if you want to use a mesh api, bind it",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"Mesh"},static:!1,readonly:!1,defaultValue:"..."},{name:"position",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"rotation",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"scaling",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1}],name:"Cylinder.svelte"};const je={title:"mesh/Cylinder",tags:["autodocs"],component:J},{Story:Ne}=Me();var Re=we("<!> <!> <!>",1);function pe(s,r){Ce(r,!1),ge(),Ne(s,{name:"Docs",args:{options:{arc:void 0,backUVs:{x:0,y:0,z:1,w:1},cap:void 0,diameter:4,diameterBottom:void 0,diameterTop:void 0,enclose:void 0,faceColors:[{r:1,g:1,b:1,a:1}],faceUV:[{x:0,y:0,z:1,w:1}],frontUVs:{x:0,y:0,z:1,w:1},hasRings:void 0,height:4,sideOrientation:void 0,subdivisions:void 0,tessellation:void 0,updatable:void 0},position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scaling:{x:1,y:1,z:1}},children:(c,t=ve)=>{Fe(c,{style:"width: 100%;",children:(x,p)=>{Le(x,{children:(w,M)=>{Pe(w,{children:($,K)=>{var o=Re(),n=ke(o);Ee(n,{position:new _(0,5,-10)});var R=re(n,2);Oe(R,{direction:new _(0,1,0),intensity:.7});var q=re(R,2),L=_e(()=>{var m,a;return{...t().options,faceUV:(m=t().options.faceUV)==null?void 0:m.map(i=>new Z(i.x,i.y,i.z,i.w)),faceColors:(a=t().options.faceColors)==null?void 0:a.map(i=>new ce(i.r,i.g,i.b,i.a)),frontUVs:t().options.frontUVs?new Z(t().options.frontUVs.x,t().options.frontUVs.y,t().options.frontUVs.z,t().options.frontUVs.w):void 0,backUVs:t().options.backUVs?new Z(t().options.backUVs.x,t().options.backUVs.y,t().options.backUVs.z,t().options.backUVs.w):void 0}});J(q,{get options(){return Ue(L)},get position(){return t().position},get rotation(){return t().rotation},get scaling(){return t().scaling}}),Ve($,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0},parameters:{__svelteCsf:{rawCode:`<Canvas style="width: 100%;">
  <Engine>
    <Scene>
      <FreeCamera position={new Vector3(0, 5, -10)} />
      <HemisphericLight direction={new Vector3(0, 1, 0)} intensity={0.7} />
      <Cylinder
        options={{
          ...args.options!,
          faceUV: args.options!.faceUV?.map((v) => new Vector4(v.x, v.y, v.z, v.w)),
          faceColors: args.options!.faceColors?.map((v) => new Color4(v.r, v.g, v.b, v.a)),
          frontUVs: args.options!.frontUVs
            ? new Vector4(
                args.options!.frontUVs.x,
                args.options!.frontUVs.y,
                args.options!.frontUVs.z,
                args.options!.frontUVs.w
              )
            : undefined,
          backUVs: args.options!.backUVs
            ? new Vector4(
                args.options!.backUVs.x,
                args.options!.backUVs.y,
                args.options!.backUVs.z,
                args.options!.backUVs.w
              )
            : undefined
        }}
        position={args.position}
        rotation={args.rotation}
        scaling={args.scaling}
      />
    </Scene>
  </Engine>
</Canvas>`}}}),ze()}pe.__docgen={version:3,name:"Cylinder.stories.svelte",data:[],computed:[],methods:[],components:[],description:null,keywords:[],events:[],slots:[],refs:[]};const Be=Ae(pe,je),Ke=["Docs"],Qe=Be.Docs;export{Qe as Docs,Ke as __namedExportsOrder,je as default};
