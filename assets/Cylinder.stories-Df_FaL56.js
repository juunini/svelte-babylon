import{p as he,s as be,r as xe,i as ge,a as Ve,t as we}from"./props-D_CwaEcb.js";import{p as Ce,a as ze,f as Ue,b as ke,n as ve,c as ce,d as _e}from"./index-client-a4XWVA08.js";import{h as G,M as L,t as $e,l as de,f as J,V as D,A as Se,e as le,m as De,n as Ae,o as Me,p as Fe,q as Le,r as Pe,F as Ee,H as Oe}from"./create-runtime-stories-C658kcdY.js";import"./iframe-Dzwdsmzj.js";import"../sb-preview/runtime.js";import"./index-D-8MO0q_.js";import"./index-BHYIh-Xd.js";import"./_commonjsHelpers-Cpj98o6Y.js";function pe(s){const r=s.height||2;let y=s.diameterTop===0?0:s.diameterTop||s.diameter||1,l=s.diameterBottom===0?0:s.diameterBottom||s.diameter||1;y=y||1e-5,l=l||1e-5;const t=(s.tessellation||24)|0,x=(s.subdivisions||1)|0,u=!!s.hasRings,z=!!s.enclose,P=s.cap===0?0:s.cap||L.CAP_ALL,A=s.arc&&(s.arc<=0||s.arc>1)?1:s.arc||1,X=s.sideOrientation===0?0:s.sideOrientation||G.DEFAULTSIDE,o=s.faceUV||new Array(3),n=s.faceColors,I=A!==1&&z?2:0,K=u?x:1,O=2+(1+I)*K;let m;for(m=0;m<O;m++)n&&n[m]===void 0&&(n[m]=new de(1,1,1,1));for(m=0;m<O;m++)o&&o[m]===void 0&&(o[m]=new J(0,0,1,1));const a=[],h=[],d=[],g=[],U=[],Z=Math.PI*2*A/t;let j,M,N;const H=(l-y)/2/r,c=D.Zero(),i=D.Zero(),E=D.Zero(),V=D.Zero(),p=D.Zero(),ee=Se.Y;let f,b,T,te=1,e=1,q=0,k=0;for(f=0;f<=x;f++)for(M=f/x,N=(M*(y-l)+l)/2,te=u&&f!==0&&f!==x?2:1,T=0;T<te;T++){for(u&&(e+=T),z&&(e+=2*T),b=0;b<=t;b++)j=b*Z,c.x=Math.cos(-j)*N,c.y=-r/2+M*r,c.z=Math.sin(-j)*N,y===0&&f===x?(i.x=d[d.length-(t+1)*3],i.y=d[d.length-(t+1)*3+1],i.z=d[d.length-(t+1)*3+2]):(i.x=c.x,i.z=c.z,i.y=Math.sqrt(i.x*i.x+i.z*i.z)*H,i.normalize()),b===0&&(E.copyFrom(c),V.copyFrom(i)),h.push(c.x,c.y,c.z),d.push(i.x,i.y,i.z),u?k=q!==e?o[e].y:o[e].w:k=o[e].y+(o[e].w-o[e].y)*M,g.push(o[e].x+(o[e].z-o[e].x)*b/t,k),n&&U.push(n[e].r,n[e].g,n[e].b,n[e].a);A!==1&&z&&(h.push(c.x,c.y,c.z),h.push(0,c.y,0),h.push(0,c.y,0),h.push(E.x,E.y,E.z),D.CrossToRef(ee,i,p),p.normalize(),d.push(p.x,p.y,p.z,p.x,p.y,p.z),D.CrossToRef(V,ee,p),p.normalize(),d.push(p.x,p.y,p.z,p.x,p.y,p.z),u?k=q!==e?o[e+1].y:o[e+1].w:k=o[e+1].y+(o[e+1].w-o[e+1].y)*M,g.push(o[e+1].x,k),g.push(o[e+1].z,k),u?k=q!==e?o[e+2].y:o[e+2].w:k=o[e+2].y+(o[e+2].w-o[e+2].y)*M,g.push(o[e+2].x,k),g.push(o[e+2].z,k),n&&(U.push(n[e+1].r,n[e+1].g,n[e+1].b,n[e+1].a),U.push(n[e+1].r,n[e+1].g,n[e+1].b,n[e+1].a),U.push(n[e+2].r,n[e+2].g,n[e+2].b,n[e+2].a),U.push(n[e+2].r,n[e+2].g,n[e+2].b,n[e+2].a))),q!==e&&(q=e)}const Y=A!==1&&z?t+4:t;for(f=0,e=0;e<x;e++){let w=0,v=0,_=0,F=0;for(b=0;b<t;b++)w=f*(Y+1)+b,v=(f+1)*(Y+1)+b,_=f*(Y+1)+(b+1),F=(f+1)*(Y+1)+(b+1),a.push(w,v,_),a.push(F,_,v);A!==1&&z&&(a.push(w+2,v+2,_+2),a.push(F+2,_+2,v+2),a.push(w+4,v+4,_+4),a.push(F+4,_+4,v+4)),f=u?f+2:f+1}const ne=w=>{const v=w?y/2:l/2;if(v===0)return;let _,F,$;const C=w?o[O-1]:o[0];let S=null;n&&(S=w?n[O-1]:n[0]);const B=h.length/3,se=w?r/2:-r/2,Q=new D(0,se,0);h.push(Q.x,Q.y,Q.z),d.push(0,w?1:-1,0);const ye=C.y+(C.w-C.y)*.5;g.push(C.x+(C.z-C.x)*.5,ye),S&&U.push(S.r,S.g,S.b,S.a);const oe=new le(.5,.5);for($=0;$<=t;$++){_=Math.PI*2*$*A/t;const ie=Math.cos(-_),re=Math.sin(-_);F=new D(ie*v,se,re*v);const ae=new le(ie*oe.x+.5,re*oe.y+.5);h.push(F.x,F.y,F.z),d.push(0,w?1:-1,0);const me=C.y+(C.w-C.y)*ae.y;g.push(C.x+(C.z-C.x)*ae.x,me),S&&U.push(S.r,S.g,S.b,S.a)}for($=0;$<t;$++)w?(a.push(B),a.push(B+($+2)),a.push(B+($+1))):(a.push(B),a.push(B+($+1)),a.push(B+($+2)))};(P===L.CAP_START||P===L.CAP_ALL)&&ne(!1),(P===L.CAP_END||P===L.CAP_ALL)&&ne(!0),G._ComputeSides(X,h,a,d,g,s.frontUVs,s.backUVs);const R=new G;return R.indices=a,R.positions=h,R.normals=d,R.uvs=g,n&&(R.colors=U),R}function ue(s,r={},y){const l=new L(s,y);return r.sideOrientation=L._GetDefaultSideOrientation(r.sideOrientation),l._originalBuilderSideOrientation=r.sideOrientation,pe(r).applyToMesh(l,r.updatable),l}G.CreateCylinder=pe;L.CreateCylinder=(s,r,y,l,t,x,u,z,P)=>((u===void 0||!(u instanceof $e))&&(u!==void 0&&(P=z||L.DEFAULTSIDE,z=u),u=x,x=1),ue(s,{height:r,diameterTop:y,diameterBottom:l,tessellation:t,subdivisions:x,sideOrientation:P,updatable:z},u));function W(s,r){let y=he(r,"mesh",15),l=xe(r,["$$slots","$$events","$$legacy","mesh"]);De(s,be({createMeshFunction:ue},()=>l,{get mesh(){return y()},set mesh(t){y(t)}}))}W.__docgen={data:[{name:"options",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ arc?: number | undefined; backUVs?: Vector4 | undefined; cap?: number | undefined; diameter?: number | undefined; diameterBottom?: number | undefined; diameterTop?: number | undefined; ... 9 more ...; updatable?: boolean | undefined; }"},static:!1,readonly:!1},{name:"scene",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"Scene"},static:!1,readonly:!1},{name:"children",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"Snippet<[]>"},static:!1,readonly:!1},{name:"mesh",visibility:"public",description:"if you want to use a mesh api, bind it",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"Mesh"},static:!1,readonly:!1,defaultValue:"..."},{name:"position",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"rotation",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"scaling",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1}],name:"Cylinder.svelte"};const je={title:"mesh/Cylinder",tags:["autodocs"],component:W},{Story:Ne}=Me();var Re=we("<!> <!> <!>",1);function fe(s,r){Ce(r,!1),ge(),Ne(s,{name:"Docs",args:{options:{arc:void 0,backUVs:{x:0,y:0,z:1,w:1},cap:void 0,diameter:4,diameterBottom:void 0,diameterTop:void 0,enclose:void 0,faceColors:[{r:1,g:1,b:1,a:1}],faceUV:[{x:0,y:0,z:1,w:1}],frontUVs:{x:0,y:0,z:1,w:1},hasRings:void 0,height:4,sideOrientation:void 0,subdivisions:void 0,tessellation:void 0,updatable:void 0},position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scaling:{x:1,y:1,z:1}},children:(l,t=ve)=>{Fe(l,{style:"width: 100%;",children:(x,u)=>{Le(x,{children:(z,P)=>{Pe(z,{children:(A,X)=>{var o=Re(),n=Ue(o);Ee(n,{position:new D(0,5,-10)});var I=ce(n,2);Oe(I,{direction:new D(0,1,0),intensity:.7});var K=ce(I,2),O=_e(()=>{var m,a,h,d,g,U,Z,j,M,N,H,c,i,E;return{...t().options,faceUV:(a=(m=t().options)==null?void 0:m.faceUV)==null?void 0:a.map(V=>new J(V.x,V.y,V.z,V.w)),faceColors:(d=(h=t().options)==null?void 0:h.faceColors)==null?void 0:d.map(V=>new de(V.r,V.g,V.b,V.a)),frontUVs:(g=t().options)!=null&&g.frontUVs?new J((U=t().options)==null?void 0:U.frontUVs.x,(Z=t().options)==null?void 0:Z.frontUVs.y,(j=t().options)==null?void 0:j.frontUVs.z,(M=t().options)==null?void 0:M.frontUVs.w):void 0,backUVs:(N=t().options)!=null&&N.backUVs?new J((H=t().options)==null?void 0:H.backUVs.x,(c=t().options)==null?void 0:c.backUVs.y,(i=t().options)==null?void 0:i.backUVs.z,(E=t().options)==null?void 0:E.backUVs.w):void 0}});W(K,{get options(){return ke(O)},get position(){return t().position},get rotation(){return t().rotation},get scaling(){return t().scaling}}),Ve(A,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0},parameters:{__svelteCsf:{rawCode:`<Canvas style="width: 100%;">
  <Engine>
    <Scene>
      <FreeCamera position={new Vector3(0, 5, -10)} />
      <HemisphericLight direction={new Vector3(0, 1, 0)} intensity={0.7} />
      <Cylinder
        options={{
          ...args.options,
          faceUV: args.options?.faceUV?.map((v) => new Vector4(v.x, v.y, v.z, v.w)),
          faceColors: args.options?.faceColors?.map((v) => new Color4(v.r, v.g, v.b, v.a)),
          frontUVs: args.options?.frontUVs
            ? new Vector4(
                args.options?.frontUVs.x,
                args.options?.frontUVs.y,
                args.options?.frontUVs.z,
                args.options?.frontUVs.w
              )
            : undefined,
          backUVs: args.options?.backUVs
            ? new Vector4(
                args.options?.backUVs.x,
                args.options?.backUVs.y,
                args.options?.backUVs.z,
                args.options?.backUVs.w
              )
            : undefined
        }}
        position={args.position}
        rotation={args.rotation}
        scaling={args.scaling}
      />
    </Scene>
  </Engine>
</Canvas>`}}}),ze()}fe.__docgen={version:3,name:"Cylinder.stories.svelte",data:[],computed:[],methods:[],components:[],description:null,keywords:[],events:[],slots:[],refs:[]};const Be=Ae(fe,je),Ke=["Docs"],Qe=Be.Docs;export{Qe as Docs,Ke as __namedExportsOrder,je as default};
