import{p as ce,s as ke,r as ve,i as ge,a as we,t as Ce}from"./props-CDwtXEPn.js";import{p as de,a as ye,f as Ve,g as Se,n as ze,s as le,d as Ue}from"./index-client-0IVJ1HVs.js";import{v as X,M as A,z as Pe,n as ue,m as G,V as _,D as Ee,x as pe,w as _e,k as Te,c as De,d as Le,C as Ae,E as Ie,S as Ne,H as Oe}from"./create-runtime-stories-D2yFG5at.js";import{F as Me}from"./FreeCamera-B8cQlsl3.js";import"./iframe-2opK77xr.js";import"../sb-preview/runtime.js";import"./index-D-8MO0q_.js";import"./index-BHYIh-Xd.js";import"./_commonjsHelpers-Cpj98o6Y.js";function fe(s){const a=s.height||2;let f=s.diameterTop===0?0:s.diameterTop||s.diameter||1,l=s.diameterBottom===0?0:s.diameterBottom||s.diameter||1;f=f||1e-5,l=l||1e-5;const t=(s.tessellation||24)|0,h=(s.subdivisions||1)|0,y=!!s.hasRings,C=!!s.enclose,I=s.cap===0?0:s.cap||A.CAP_ALL,T=s.arc&&(s.arc<=0||s.arc>1)?1:s.arc||1,W=s.sideOrientation===0?0:s.sideOrientation||X.DEFAULTSIDE,i=s.faceUV||new Array(3),n=s.faceColors,B=T!==1&&C?2:0,J=y?h:1,O=2+(1+B)*J;let m;for(m=0;m<O;m++)n&&n[m]===void 0&&(n[m]=new ue(1,1,1,1));for(m=0;m<O;m++)i&&i[m]===void 0&&(i[m]=new G(0,0,1,1));const r=[],b=[],p=[],k=[],V=[],Y=Math.PI*2*T/t;let M,D,R;const Z=(l-f)/2/a,c=_.Zero(),o=_.Zero(),N=_.Zero(),v=_.Zero(),d=_.Zero(),ee=Ee.Y;let u,x,F,te=1,e=1,j=0,S=0;for(u=0;u<=h;u++)for(D=u/h,R=(D*(f-l)+l)/2,te=y&&u!==0&&u!==h?2:1,F=0;F<te;F++){for(y&&(e+=F),C&&(e+=2*F),x=0;x<=t;x++)M=x*Y,c.x=Math.cos(-M)*R,c.y=-a/2+D*a,c.z=Math.sin(-M)*R,f===0&&u===h?(o.x=p[p.length-(t+1)*3],o.y=p[p.length-(t+1)*3+1],o.z=p[p.length-(t+1)*3+2]):(o.x=c.x,o.z=c.z,o.y=Math.sqrt(o.x*o.x+o.z*o.z)*Z,o.normalize()),x===0&&(N.copyFrom(c),v.copyFrom(o)),b.push(c.x,c.y,c.z),p.push(o.x,o.y,o.z),y?S=j!==e?i[e].y:i[e].w:S=i[e].y+(i[e].w-i[e].y)*D,k.push(i[e].x+(i[e].z-i[e].x)*x/t,S),n&&V.push(n[e].r,n[e].g,n[e].b,n[e].a);T!==1&&C&&(b.push(c.x,c.y,c.z),b.push(0,c.y,0),b.push(0,c.y,0),b.push(N.x,N.y,N.z),_.CrossToRef(ee,o,d),d.normalize(),p.push(d.x,d.y,d.z,d.x,d.y,d.z),_.CrossToRef(v,ee,d),d.normalize(),p.push(d.x,d.y,d.z,d.x,d.y,d.z),y?S=j!==e?i[e+1].y:i[e+1].w:S=i[e+1].y+(i[e+1].w-i[e+1].y)*D,k.push(i[e+1].x,S),k.push(i[e+1].z,S),y?S=j!==e?i[e+2].y:i[e+2].w:S=i[e+2].y+(i[e+2].w-i[e+2].y)*D,k.push(i[e+2].x,S),k.push(i[e+2].z,S),n&&(V.push(n[e+1].r,n[e+1].g,n[e+1].b,n[e+1].a),V.push(n[e+1].r,n[e+1].g,n[e+1].b,n[e+1].a),V.push(n[e+2].r,n[e+2].g,n[e+2].b,n[e+2].a),V.push(n[e+2].r,n[e+2].g,n[e+2].b,n[e+2].a))),j!==e&&(j=e)}const q=T!==1&&C?t+4:t;for(u=0,e=0;e<h;e++){let g=0,z=0,U=0,L=0;for(x=0;x<t;x++)g=u*(q+1)+x,z=(u+1)*(q+1)+x,U=u*(q+1)+(x+1),L=(u+1)*(q+1)+(x+1),r.push(g,z,U),r.push(L,U,z);T!==1&&C&&(r.push(g+2,z+2,U+2),r.push(L+2,U+2,z+2),r.push(g+4,z+4,U+4),r.push(L+4,U+4,z+4)),u=y?u+2:u+1}const ne=g=>{const z=g?f/2:l/2;if(z===0)return;let U,L,P;const w=g?i[O-1]:i[0];let E=null;n&&(E=g?n[O-1]:n[0]);const H=b.length/3,se=g?a/2:-a/2,K=new _(0,se,0);b.push(K.x,K.y,K.z),p.push(0,g?1:-1,0);const be=w.y+(w.w-w.y)*.5;k.push(w.x+(w.z-w.x)*.5,be),E&&V.push(E.r,E.g,E.b,E.a);const ie=new pe(.5,.5);for(P=0;P<=t;P++){U=Math.PI*2*P*T/t;const ae=Math.cos(-U),oe=Math.sin(-U);L=new _(ae*z,se,oe*z);const re=new pe(ae*ie.x+.5,oe*ie.y+.5);b.push(L.x,L.y,L.z),p.push(0,g?1:-1,0);const xe=w.y+(w.w-w.y)*re.y;k.push(w.x+(w.z-w.x)*re.x,xe),E&&V.push(E.r,E.g,E.b,E.a)}for(P=0;P<t;P++)g?(r.push(H),r.push(H+(P+2)),r.push(H+(P+1))):(r.push(H),r.push(H+(P+1)),r.push(H+(P+2)))};(I===A.CAP_START||I===A.CAP_ALL)&&ne(!1),(I===A.CAP_END||I===A.CAP_ALL)&&ne(!0),X._ComputeSides(W,b,r,p,k,s.frontUVs,s.backUVs);const $=new X;return $.indices=r,$.positions=b,$.normals=p,$.uvs=k,n&&($.colors=V),$}function he(s,a={},f){const l=new A(s,f);return a.sideOrientation=A._GetDefaultSideOrientation(a.sideOrientation),l._originalBuilderSideOrientation=a.sideOrientation,fe(a).applyToMesh(l,a.updatable),l}X.CreateCylinder=fe;A.CreateCylinder=(s,a,f,l,t,h,y,C,I)=>((y===void 0||!(y instanceof Pe))&&(y!==void 0&&(I=C||A.DEFAULTSIDE,C=y),y=h,h=1),he(s,{height:a,diameterTop:f,diameterBottom:l,tessellation:t,subdivisions:h,sideOrientation:I,updatable:C},y));function Q(s,a){de(a,!0);let f=ce(a,"mesh",15),l=ce(a,"physicsShape",19,()=>_e.CYLINDER),t=ve(a,["$$slots","$$events","$$legacy","mesh","physicsShape"]);Te(s,ke({createMeshFunction:he,get physicsShape(){return l()}},()=>t,{get mesh(){return f()},set mesh(h){f(h)}})),ye()}Q.__docgen={data:[{name:"options",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ arc?: number | undefined; backUVs?: Vector4 | undefined; cap?: number | undefined; diameter?: number | undefined; diameterBottom?: number | undefined; diameterTop?: number | undefined; ... 9 more ...; updatable?: boolean | undefined; }"},static:!1,readonly:!1},{name:"scene",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"Scene"},static:!1,readonly:!1},{name:"children",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"Snippet<[]>"},static:!1,readonly:!1},{name:"mesh",visibility:"public",description:"if you want to use a mesh api, bind it",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"Mesh"},static:!1,readonly:!1,defaultValue:"..."},{name:"physics",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1},{name:"physicsShape",visibility:"public",keywords:[],kind:"let",type:{kind:"union",type:[{kind:"const",type:"number",value:0,text:"PhysicsShapeType.SPHERE"},{kind:"const",type:"number",value:1,text:"PhysicsShapeType.CAPSULE"},{kind:"const",type:"number",value:2,text:"PhysicsShapeType.CYLINDER"},{kind:"const",type:"number",value:3,text:"PhysicsShapeType.BOX"},{kind:"const",type:"number",value:4,text:"PhysicsShapeType.CONVEX_HULL"},{kind:"const",type:"number",value:5,text:"PhysicsShapeType.CONTAINER"},{kind:"const",type:"number",value:6,text:"PhysicsShapeType.MESH"},{kind:"const",type:"number",value:7,text:"PhysicsShapeType.HEIGHTFIELD"},{kind:"type",type:"object",text:"PhysicsShape"}],text:"PhysicsShapeType.SPHERE | PhysicsShapeType.CAPSULE | PhysicsShapeType.CYLINDER | PhysicsShapeType.BOX | PhysicsShapeType.CONVEX_HULL | PhysicsShapeType.CONTAINER | PhysicsShapeType.MESH | PhysicsShapeType.HEIGHTFIELD | PhysicsShape"},static:!1,readonly:!1,defaultValue:"PhysicsShapeType.CYLINDER"},{name:"physicsOptions",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"PhysicsAggregateParameters"},static:!1,readonly:!1},{name:"position",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"rotation",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"scaling",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"force",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"impulse",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"onCollision",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"(eventData: IPhysicsCollisionEvent, eventState: EventState) => void"},static:!1,readonly:!1},{name:"onCollisionOnce",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"(eventData: IPhysicsCollisionEvent, eventState: EventState) => void"},static:!1,readonly:!1}],name:"Cylinder.svelte"};const Re={title:"mesh/Cylinder",tags:["autodocs"],component:Q},{Story:$e}=Le();var He=Ce("<!> <!> <!>",1);function me(s,a){de(a,!1),ge(),$e(s,{name:"Docs",args:{options:{arc:void 0,backUVs:{x:0,y:0,z:1,w:1},cap:void 0,diameter:4,diameterBottom:void 0,diameterTop:void 0,enclose:void 0,faceColors:[{r:1,g:1,b:1,a:1}],faceUV:[{x:0,y:0,z:1,w:1}],frontUVs:{x:0,y:0,z:1,w:1},hasRings:void 0,height:4,sideOrientation:void 0,subdivisions:void 0,tessellation:void 0,updatable:void 0},position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scaling:{x:1,y:1,z:1}},children:(l,t=ze)=>{Ae(l,{style:"width: 100%;",children:(h,y)=>{Ie(h,{children:(C,I)=>{Ne(C,{children:(T,W)=>{var i=He(),n=Ve(i);Me(n,{position:new _(0,5,-10)});var B=le(n,2);Oe(B,{direction:new _(0,1,0),intensity:.7});var J=le(B,2),O=Ue(()=>{var m,r,b,p,k,V,Y,M,D,R,Z,c,o,N;return{...t().options,faceUV:(r=(m=t().options)==null?void 0:m.faceUV)==null?void 0:r.map(v=>new G(v.x,v.y,v.z,v.w)),faceColors:(p=(b=t().options)==null?void 0:b.faceColors)==null?void 0:p.map(v=>new ue(v.r,v.g,v.b,v.a)),frontUVs:(k=t().options)!=null&&k.frontUVs?new G((V=t().options)==null?void 0:V.frontUVs.x,(Y=t().options)==null?void 0:Y.frontUVs.y,(M=t().options)==null?void 0:M.frontUVs.z,(D=t().options)==null?void 0:D.frontUVs.w):void 0,backUVs:(R=t().options)!=null&&R.backUVs?new G((Z=t().options)==null?void 0:Z.backUVs.x,(c=t().options)==null?void 0:c.backUVs.y,(o=t().options)==null?void 0:o.backUVs.z,(N=t().options)==null?void 0:N.backUVs.w):void 0}});Q(J,{get options(){return Se(O)},get position(){return t().position},get rotation(){return t().rotation},get scaling(){return t().scaling}}),we(T,i)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0},parameters:{__svelteCsf:{rawCode:`<Canvas style="width: 100%;">
  <Engine>
    <Scene>
      <FreeCamera position={new Vector3(0, 5, -10)} />
      <HemisphericLight direction={new Vector3(0, 1, 0)} intensity={0.7} />
      <Cylinder
        options={{
          ...args.options,
          faceUV: args.options?.faceUV?.map((v) => new Vector4(v.x, v.y, v.z, v.w)),
          faceColors: args.options?.faceColors?.map((v) => new Color4(v.r, v.g, v.b, v.a)),
          frontUVs: args.options?.frontUVs
            ? new Vector4(
                args.options?.frontUVs.x,
                args.options?.frontUVs.y,
                args.options?.frontUVs.z,
                args.options?.frontUVs.w
              )
            : undefined,
          backUVs: args.options?.backUVs
            ? new Vector4(
                args.options?.backUVs.x,
                args.options?.backUVs.y,
                args.options?.backUVs.z,
                args.options?.backUVs.w
              )
            : undefined
        }}
        position={args.position}
        rotation={args.rotation}
        scaling={args.scaling}
      />
    </Scene>
  </Engine>
</Canvas>`}}}),ye()}me.__docgen={version:3,name:"Cylinder.stories.svelte",data:[],computed:[],methods:[],components:[],description:null,keywords:[],events:[],slots:[],refs:[]};const Fe=De(me,Re),Qe=["Docs"],We=Fe.Docs;export{We as Docs,Qe as __namedExportsOrder,Re as default};
