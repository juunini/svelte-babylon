import{p as tt,s as et,r as st,i as nt,a as it,t as ot}from"./props-D_CwaEcb.js";import{p as at,a as rt,f as ct,b as lt,n as pt,c as Q,d as ut}from"./index-client-a4XWVA08.js";import{M as J,f as K,V as b,c as G,q as dt,k as ht,l as mt,m as yt,n as ft,o as bt,p as vt,F as xt,H as gt}from"./create-runtime-stories-BkvPK9tB.js";import"./iframe-DOBaK8HO.js";import"../sb-preview/runtime.js";import"./index-D-8MO0q_.js";import"./index-BHYIh-Xd.js";import"./_commonjsHelpers-Cpj98o6Y.js";function N(t={subdivisions:2,tessellation:16,height:1,radius:.25,capSubdivisions:6}){const h=Math.max(t.subdivisions?t.subdivisions:2,1)|0,v=Math.max(t.tessellation?t.tessellation:16,3)|0,f=Math.max(t.height?t.height:1,0),r=Math.max(t.radius?t.radius:.25,0),I=Math.max(t.capSubdivisions?t.capSubdivisions:6,1)|0,x=v,C=h,a=Math.max(t.radiusTop?t.radiusTop:r,0),c=Math.max(t.radiusBottom?t.radiusBottom:r,0),U=f-(a+c),z=0,$=2*Math.PI,_=Math.max(t.topCapSubdivisions?t.topCapSubdivisions:I,1),T=Math.max(t.bottomCapSubdivisions?t.bottomCapSubdivisions:I,1),m=Math.acos((c-a)/f);let u=[];const l=[],w=[],S=[];let D=0;const k=[],A=U*.5,F=Math.PI*.5;let n,s;const d=b.Zero(),i=b.Zero(),P=Math.cos(m),E=Math.sin(m),Z=new G(a*E,A+a*P).subtract(new G(c*E,-A+c*P)).length(),L=a*m+Z+c*(F-m);let V=0;for(s=0;s<=_;s++){const p=[],o=F-m*(s/_);V+=a*m/_;const e=Math.cos(o),y=Math.sin(o),g=e*a;for(n=0;n<=x;n++){const M=n/x,R=M*$+z,B=Math.sin(R),H=Math.cos(R);i.x=g*B,i.y=A+y*a,i.z=g*H,l.push(i.x,i.y,i.z),d.set(e*B,y,e*H),w.push(d.x,d.y,d.z),S.push(M,1-V/L),p.push(D),D++}k.push(p)}const O=f-a-c+P*a-P*c,Y=E*(c-a)/O;for(s=1;s<=C;s++){const p=[];V+=Z/C;const o=E*(s*(c-a)/C+a);for(n=0;n<=x;n++){const e=n/x,y=e*$+z,g=Math.sin(y),M=Math.cos(y);i.x=o*g,i.y=A+P*a-s*O/C,i.z=o*M,l.push(i.x,i.y,i.z),d.set(g,Y,M).normalize(),w.push(d.x,d.y,d.z),S.push(e,1-V/L),p.push(D),D++}k.push(p)}for(s=1;s<=T;s++){const p=[],o=F-m-(Math.PI-m)*(s/T);V+=c*m/T;const e=Math.cos(o),y=Math.sin(o),g=e*c;for(n=0;n<=x;n++){const M=n/x,R=M*$+z,B=Math.sin(R),H=Math.cos(R);i.x=g*B,i.y=-A+y*c,i.z=g*H,l.push(i.x,i.y,i.z),d.set(e*B,y,e*H),w.push(d.x,d.y,d.z),S.push(M,1-V/L),p.push(D),D++}k.push(p)}for(n=0;n<x;n++)for(s=0;s<_+C+T;s++){const p=k[s][n],o=k[s+1][n],e=k[s+1][n+1],y=k[s][n+1];u.push(p),u.push(o),u.push(y),u.push(o),u.push(e),u.push(y)}if(u=u.reverse(),t.orientation&&!t.orientation.equals(b.Up())){const p=new dt;t.orientation.clone().scale(Math.PI*.5).cross(b.Up()).toQuaternion().toRotationMatrix(p);const o=b.Zero();for(let e=0;e<l.length;e+=3)o.set(l[e],l[e+1],l[e+2]),b.TransformCoordinatesToRef(o.clone(),p,o),l[e]=o.x,l[e+1]=o.y,l[e+2]=o.z}const j=new K;return j.positions=l,j.normals=w,j.uvs=S,j.indices=u,j}function W(t,h={orientation:b.Up(),subdivisions:2,tessellation:16,height:1,radius:.25,capSubdivisions:6,updatable:!1},v=null){const f=new J(t,v);return N(h).applyToMesh(f,h.updatable),f}J.CreateCapsule=(t,h,v)=>W(t,h,v);K.CreateCapsule=N;function q(t,h){let v=tt(h,"mesh",15),f=st(h,["$$slots","$$events","$$legacy","mesh"]);ht(t,et({createMeshFunction:W},()=>f,{get mesh(){return v()},set mesh(r){v(r)}}))}q.__docgen={data:[{name:"options",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"ICreateCapsuleOptions"},static:!1,readonly:!1},{name:"scene",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"Scene"},static:!1,readonly:!1},{name:"children",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"Snippet<[]>"},static:!1,readonly:!1},{name:"mesh",visibility:"public",description:"if you want to use a mesh api, bind it",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"Mesh"},static:!1,readonly:!1,defaultValue:"..."},{name:"position",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"rotation",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"scaling",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1}],name:"Capsule.svelte"};const Mt={title:"mesh/Capsule",tags:["autodocs"],component:q},{Story:Ct}=yt();var _t=ot("<!> <!> <!>",1);function X(t,h){at(h,!1),nt(),Ct(t,{name:"Docs",args:{options:{orientation:{x:0,y:0,z:0},subdivisions:void 0,tessellation:void 0,height:4,radius:1,capSubdivisions:void 0,radiusTop:void 0,radiusBottom:void 0,topCapSubdivisions:void 0,bottomCapSubdivisions:void 0,updatable:void 0},position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scaling:{x:1,y:1,z:1}},children:(f,r=pt)=>{ft(f,{style:"width: 100%;",children:(I,x)=>{bt(I,{children:(C,a)=>{vt(C,{children:(c,U)=>{var z=_t(),$=ct(z);xt($,{position:new b(0,5,-10)});var _=Q($,2);gt(_,{direction:new b(0,1,0),intensity:.7});var T=Q(_,2),m=ut(()=>{var u,l,w,S;return{...r().options,orientation:(u=r().options)!=null&&u.orientation?new b((l=r().options)==null?void 0:l.orientation.x,(w=r().options)==null?void 0:w.orientation.y,(S=r().options)==null?void 0:S.orientation.z):void 0}});q(T,{get options(){return lt(m)},get position(){return r().position},get rotation(){return r().rotation},get scaling(){return r().scaling}}),it(c,z)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0},parameters:{__svelteCsf:{rawCode:`<Canvas style="width: 100%;">
  <Engine>
    <Scene>
      <FreeCamera position={new Vector3(0, 5, -10)} />
      <HemisphericLight direction={new Vector3(0, 1, 0)} intensity={0.7} />
      <Capsule
        options={{
          ...args.options,
          orientation: args.options?.orientation
            ? new Vector3(
                args.options?.orientation.x,
                args.options?.orientation.y,
                args.options?.orientation.z
              )
            : undefined
        }}
        position={args.position}
        rotation={args.rotation}
        scaling={args.scaling}
      />
    </Scene>
  </Engine>
</Canvas>`}}}),rt()}X.__docgen={version:3,name:"Capsule.stories.svelte",data:[],computed:[],methods:[],components:[],description:null,keywords:[],events:[],slots:[],refs:[]};const wt=mt(X,Mt),Pt=["Docs"],jt=wt.Docs;export{jt as Docs,Pt as __namedExportsOrder,Mt as default};
