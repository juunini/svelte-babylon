import{p as Z,s as ne,r as ie,i as ae,a as oe,t as ce}from"./props-CDwtXEPn.js";import{p as Y,a as Q,f as re,g as pe,n as le,s as q,d as he}from"./index-client-0IVJ1HVs.js";import{M as J,t as K,V as f,v as G,w as ue,u as de,e as ye,f as me,g as be,i as fe,j as ve,k as xe,F as Se,H as ge}from"./create-runtime-stories-L4uVnNlK.js";import"./iframe-ZhyaJ0jc.js";import"../sb-preview/runtime.js";import"./index-D-8MO0q_.js";import"./index-BHYIh-Xd.js";import"./_commonjsHelpers-Cpj98o6Y.js";function W(e={subdivisions:2,tessellation:16,height:1,radius:.25,capSubdivisions:6}){const l=Math.max(e.subdivisions?e.subdivisions:2,1)|0,v=Math.max(e.tessellation?e.tessellation:16,3)|0,b=Math.max(e.height?e.height:1,0),c=Math.max(e.radius?e.radius:.25,0),w=Math.max(e.capSubdivisions?e.capSubdivisions:6,1)|0,x=v,k=l,o=Math.max(e.radiusTop?e.radiusTop:c,0),r=Math.max(e.radiusBottom?e.radiusBottom:c,0),B=b-(o+r),_=0,E=2*Math.PI,C=Math.max(e.topCapSubdivisions?e.topCapSubdivisions:w,1),z=Math.max(e.bottomCapSubdivisions?e.bottomCapSubdivisions:w,1),y=Math.acos((r-o)/b);let u=[];const p=[],M=[],T=[];let L=0;const P=[],A=B*.5,O=Math.PI*.5;let n,s;const d=f.Zero(),i=f.Zero(),D=Math.cos(y),j=Math.sin(y),F=new G(o*j,A+o*D).subtract(new G(r*j,-A+r*D)).length(),U=o*y+F+r*(O-y);let H=0;for(s=0;s<=C;s++){const h=[],a=O-y*(s/C);H+=o*y/C;const t=Math.cos(a),m=Math.sin(a),S=t*o;for(n=0;n<=x;n++){const g=n/x,I=g*E+_,R=Math.sin(I),V=Math.cos(I);i.x=S*R,i.y=A+m*o,i.z=S*V,p.push(i.x,i.y,i.z),d.set(t*R,m,t*V),M.push(d.x,d.y,d.z),T.push(g,1-H/U),h.push(L),L++}P.push(h)}const X=b-o-r+D*o-D*r,se=j*(r-o)/X;for(s=1;s<=k;s++){const h=[];H+=F/k;const a=j*(s*(r-o)/k+o);for(n=0;n<=x;n++){const t=n/x,m=t*E+_,S=Math.sin(m),g=Math.cos(m);i.x=a*S,i.y=A+D*o-s*X/k,i.z=a*g,p.push(i.x,i.y,i.z),d.set(S,se,g).normalize(),M.push(d.x,d.y,d.z),T.push(t,1-H/U),h.push(L),L++}P.push(h)}for(s=1;s<=z;s++){const h=[],a=O-y-(Math.PI-y)*(s/z);H+=r*y/z;const t=Math.cos(a),m=Math.sin(a),S=t*r;for(n=0;n<=x;n++){const g=n/x,I=g*E+_,R=Math.sin(I),V=Math.cos(I);i.x=S*R,i.y=-A+m*r,i.z=S*V,p.push(i.x,i.y,i.z),d.set(t*R,m,t*V),M.push(d.x,d.y,d.z),T.push(g,1-H/U),h.push(L),L++}P.push(h)}for(n=0;n<x;n++)for(s=0;s<C+k+z;s++){const h=P[s][n],a=P[s+1][n],t=P[s+1][n+1],m=P[s][n+1];u.push(h),u.push(a),u.push(m),u.push(a),u.push(t),u.push(m)}if(u=u.reverse(),e.orientation&&!e.orientation.equals(f.Up())){const h=new ue;e.orientation.clone().scale(Math.PI*.5).cross(f.Up()).toQuaternion().toRotationMatrix(h);const a=f.Zero();for(let t=0;t<p.length;t+=3)a.set(p[t],p[t+1],p[t+2]),f.TransformCoordinatesToRef(a.clone(),h,a),p[t]=a.x,p[t+1]=a.y,p[t+2]=a.z}const $=new K;return $.positions=p,$.normals=M,$.uvs=T,$.indices=u,$}function ee(e,l={orientation:f.Up(),subdivisions:2,tessellation:16,height:1,radius:.25,capSubdivisions:6,updatable:!1},v=null){const b=new J(e,v);return W(l).applyToMesh(b,l.updatable),b}J.CreateCapsule=(e,l,v)=>ee(e,l,v);K.CreateCapsule=W;function N(e,l){Y(l,!0);let v=Z(l,"mesh",15),b=Z(l,"physicsShape",19,()=>de.CAPSULE),c=ie(l,["$$slots","$$events","$$legacy","mesh","physicsShape"]);ye(e,ne({createMeshFunction:ee,get physicsShape(){return b()}},()=>c,{get mesh(){return v()},set mesh(w){v(w)}})),Q()}N.__docgen={data:[{name:"options",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"ICreateCapsuleOptions"},static:!1,readonly:!1},{name:"scene",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"Scene"},static:!1,readonly:!1},{name:"children",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"Snippet<[]>"},static:!1,readonly:!1},{name:"mesh",visibility:"public",description:"if you want to use a mesh api, bind it",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"Mesh"},static:!1,readonly:!1,defaultValue:"..."},{name:"physics",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1},{name:"physicsShape",visibility:"public",keywords:[],kind:"let",type:{kind:"union",type:[{kind:"const",type:"number",value:0,text:"PhysicsShapeType.SPHERE"},{kind:"const",type:"number",value:1,text:"PhysicsShapeType.CAPSULE"},{kind:"const",type:"number",value:2,text:"PhysicsShapeType.CYLINDER"},{kind:"const",type:"number",value:3,text:"PhysicsShapeType.BOX"},{kind:"const",type:"number",value:4,text:"PhysicsShapeType.CONVEX_HULL"},{kind:"const",type:"number",value:5,text:"PhysicsShapeType.CONTAINER"},{kind:"const",type:"number",value:6,text:"PhysicsShapeType.MESH"},{kind:"const",type:"number",value:7,text:"PhysicsShapeType.HEIGHTFIELD"},{kind:"type",type:"object",text:"PhysicsShape"}],text:"PhysicsShapeType.SPHERE | PhysicsShapeType.CAPSULE | PhysicsShapeType.CYLINDER | PhysicsShapeType.BOX | PhysicsShapeType.CONVEX_HULL | PhysicsShapeType.CONTAINER | PhysicsShapeType.MESH | PhysicsShapeType.HEIGHTFIELD | PhysicsShape"},static:!1,readonly:!1,defaultValue:"PhysicsShapeType.CAPSULE"},{name:"physicsOptions",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"PhysicsAggregateParameters"},static:!1,readonly:!1},{name:"position",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"rotation",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"scaling",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1}],name:"Capsule.svelte"};const ke={title:"mesh/Capsule",tags:["autodocs"],component:N},{Story:Ce}=be();var Me=ce("<!> <!> <!>",1);function te(e,l){Y(l,!1),ae(),Ce(e,{name:"Docs",args:{options:{orientation:{x:0,y:0,z:0},subdivisions:void 0,tessellation:void 0,height:4,radius:1,capSubdivisions:void 0,radiusTop:void 0,radiusBottom:void 0,topCapSubdivisions:void 0,bottomCapSubdivisions:void 0,updatable:void 0},position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scaling:{x:1,y:1,z:1}},children:(b,c=le)=>{fe(b,{style:"width: 100%;",children:(w,x)=>{ve(w,{children:(k,o)=>{xe(k,{children:(r,B)=>{var _=Me(),E=re(_);Se(E,{position:new f(0,5,-10)});var C=q(E,2);ge(C,{direction:new f(0,1,0),intensity:.7});var z=q(C,2),y=he(()=>{var u,p,M,T;return{...c().options,orientation:(u=c().options)!=null&&u.orientation?new f((p=c().options)==null?void 0:p.orientation.x,(M=c().options)==null?void 0:M.orientation.y,(T=c().options)==null?void 0:T.orientation.z):void 0}});N(z,{get options(){return pe(y)},get position(){return c().position},get rotation(){return c().rotation},get scaling(){return c().scaling}}),oe(r,_)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0},parameters:{__svelteCsf:{rawCode:`<Canvas style="width: 100%;">
  <Engine>
    <Scene>
      <FreeCamera position={new Vector3(0, 5, -10)} />
      <HemisphericLight direction={new Vector3(0, 1, 0)} intensity={0.7} />
      <Capsule
        options={{
          ...args.options,
          orientation: args.options?.orientation
            ? new Vector3(
                args.options?.orientation.x,
                args.options?.orientation.y,
                args.options?.orientation.z
              )
            : undefined
        }}
        position={args.position}
        rotation={args.rotation}
        scaling={args.scaling}
      />
    </Scene>
  </Engine>
</Canvas>`}}}),Q()}te.__docgen={version:3,name:"Capsule.stories.svelte",data:[],computed:[],methods:[],components:[],description:null,keywords:[],events:[],slots:[],refs:[]};const Te=me(te,ke),De=["Docs"],$e=Te.Docs;export{$e as Docs,De as __namedExportsOrder,ke as default};
