import{p as Z,s as ne,r as ie,i as ae,a as oe,t as re}from"./props-CDwtXEPn.js";import{p as Y,a as Q,f as ce,g as pe,n as le,s as q,d as ue}from"./index-client-0IVJ1HVs.js";import{M as J,t as K,V as f,v as G,w as de,u as he,j as ye,c as me,d as be,C as fe,E as xe,S as ve,F as Se,H as ge}from"./create-runtime-stories-BdDSBu7q.js";import"./iframe-oeH-Nnzw.js";import"../sb-preview/runtime.js";import"./index-D-8MO0q_.js";import"./index-BHYIh-Xd.js";import"./_commonjsHelpers-Cpj98o6Y.js";function W(e={subdivisions:2,tessellation:16,height:1,radius:.25,capSubdivisions:6}){const l=Math.max(e.subdivisions?e.subdivisions:2,1)|0,x=Math.max(e.tessellation?e.tessellation:16,3)|0,b=Math.max(e.height?e.height:1,0),r=Math.max(e.radius?e.radius:.25,0),w=Math.max(e.capSubdivisions?e.capSubdivisions:6,1)|0,v=x,k=l,o=Math.max(e.radiusTop?e.radiusTop:r,0),c=Math.max(e.radiusBottom?e.radiusBottom:r,0),B=b-(o+c),_=0,E=2*Math.PI,C=Math.max(e.topCapSubdivisions?e.topCapSubdivisions:w,1),z=Math.max(e.bottomCapSubdivisions?e.bottomCapSubdivisions:w,1),y=Math.acos((c-o)/b);let d=[];const p=[],M=[],T=[];let L=0;const P=[],A=B*.5,O=Math.PI*.5;let n,s;const h=f.Zero(),i=f.Zero(),D=Math.cos(y),j=Math.sin(y),F=new G(o*j,A+o*D).subtract(new G(c*j,-A+c*D)).length(),U=o*y+F+c*(O-y);let H=0;for(s=0;s<=C;s++){const u=[],a=O-y*(s/C);H+=o*y/C;const t=Math.cos(a),m=Math.sin(a),S=t*o;for(n=0;n<=v;n++){const g=n/v,I=g*E+_,R=Math.sin(I),V=Math.cos(I);i.x=S*R,i.y=A+m*o,i.z=S*V,p.push(i.x,i.y,i.z),h.set(t*R,m,t*V),M.push(h.x,h.y,h.z),T.push(g,1-H/U),u.push(L),L++}P.push(u)}const X=b-o-c+D*o-D*c,se=j*(c-o)/X;for(s=1;s<=k;s++){const u=[];H+=F/k;const a=j*(s*(c-o)/k+o);for(n=0;n<=v;n++){const t=n/v,m=t*E+_,S=Math.sin(m),g=Math.cos(m);i.x=a*S,i.y=A+D*o-s*X/k,i.z=a*g,p.push(i.x,i.y,i.z),h.set(S,se,g).normalize(),M.push(h.x,h.y,h.z),T.push(t,1-H/U),u.push(L),L++}P.push(u)}for(s=1;s<=z;s++){const u=[],a=O-y-(Math.PI-y)*(s/z);H+=c*y/z;const t=Math.cos(a),m=Math.sin(a),S=t*c;for(n=0;n<=v;n++){const g=n/v,I=g*E+_,R=Math.sin(I),V=Math.cos(I);i.x=S*R,i.y=-A+m*c,i.z=S*V,p.push(i.x,i.y,i.z),h.set(t*R,m,t*V),M.push(h.x,h.y,h.z),T.push(g,1-H/U),u.push(L),L++}P.push(u)}for(n=0;n<v;n++)for(s=0;s<C+k+z;s++){const u=P[s][n],a=P[s+1][n],t=P[s+1][n+1],m=P[s][n+1];d.push(u),d.push(a),d.push(m),d.push(a),d.push(t),d.push(m)}if(d=d.reverse(),e.orientation&&!e.orientation.equals(f.Up())){const u=new de;e.orientation.clone().scale(Math.PI*.5).cross(f.Up()).toQuaternion().toRotationMatrix(u);const a=f.Zero();for(let t=0;t<p.length;t+=3)a.set(p[t],p[t+1],p[t+2]),f.TransformCoordinatesToRef(a.clone(),u,a),p[t]=a.x,p[t+1]=a.y,p[t+2]=a.z}const $=new K;return $.positions=p,$.normals=M,$.uvs=T,$.indices=d,$}function ee(e,l={orientation:f.Up(),subdivisions:2,tessellation:16,height:1,radius:.25,capSubdivisions:6,updatable:!1},x=null){const b=new J(e,x);return W(l).applyToMesh(b,l.updatable),b}J.CreateCapsule=(e,l,x)=>ee(e,l,x);K.CreateCapsule=W;function N(e,l){Y(l,!0);let x=Z(l,"mesh",15),b=Z(l,"physicsShape",19,()=>he.CAPSULE),r=ie(l,["$$slots","$$events","$$legacy","mesh","physicsShape"]);ye(e,ne({createMeshFunction:ee,get physicsShape(){return b()}},()=>r,{get mesh(){return x()},set mesh(w){x(w)}})),Q()}N.__docgen={data:[{name:"options",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"ICreateCapsuleOptions"},static:!1,readonly:!1},{name:"scene",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"Scene"},static:!1,readonly:!1},{name:"children",visibility:"public",keywords:[],kind:"let",type:{kind:"function",text:"Snippet<[]>"},static:!1,readonly:!1},{name:"mesh",visibility:"public",description:"if you want to use a mesh api, bind it",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"Mesh"},static:!1,readonly:!1,defaultValue:"..."},{name:"physics",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"boolean",text:"boolean"},static:!1,readonly:!1},{name:"physicsShape",visibility:"public",keywords:[],kind:"let",type:{kind:"union",type:[{kind:"const",type:"number",value:0,text:"PhysicsShapeType.SPHERE"},{kind:"const",type:"number",value:1,text:"PhysicsShapeType.CAPSULE"},{kind:"const",type:"number",value:2,text:"PhysicsShapeType.CYLINDER"},{kind:"const",type:"number",value:3,text:"PhysicsShapeType.BOX"},{kind:"const",type:"number",value:4,text:"PhysicsShapeType.CONVEX_HULL"},{kind:"const",type:"number",value:5,text:"PhysicsShapeType.CONTAINER"},{kind:"const",type:"number",value:6,text:"PhysicsShapeType.MESH"},{kind:"const",type:"number",value:7,text:"PhysicsShapeType.HEIGHTFIELD"},{kind:"type",type:"object",text:"PhysicsShape"}],text:"PhysicsShapeType.SPHERE | PhysicsShapeType.CAPSULE | PhysicsShapeType.CYLINDER | PhysicsShapeType.BOX | PhysicsShapeType.CONVEX_HULL | PhysicsShapeType.CONTAINER | PhysicsShapeType.MESH | PhysicsShapeType.HEIGHTFIELD | PhysicsShape"},static:!1,readonly:!1,defaultValue:"PhysicsShapeType.CAPSULE"},{name:"physicsOptions",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"PhysicsAggregateParameters"},static:!1,readonly:!1},{name:"position",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"rotation",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"scaling",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"force",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1},{name:"impulse",visibility:"public",keywords:[],kind:"let",type:{kind:"type",type:"object",text:"{ x: number; y: number; z: number; }"},static:!1,readonly:!1}],name:"Capsule.svelte"};const ke={title:"mesh/Capsule",tags:["autodocs"],component:N},{Story:Ce}=be();var Me=re("<!> <!> <!>",1);function te(e,l){Y(l,!1),ae(),Ce(e,{name:"Docs",args:{options:{orientation:{x:0,y:0,z:0},subdivisions:void 0,tessellation:void 0,height:4,radius:1,capSubdivisions:void 0,radiusTop:void 0,radiusBottom:void 0,topCapSubdivisions:void 0,bottomCapSubdivisions:void 0,updatable:void 0},position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scaling:{x:1,y:1,z:1}},children:(b,r=le)=>{fe(b,{style:"width: 100%;",children:(w,v)=>{xe(w,{children:(k,o)=>{ve(k,{children:(c,B)=>{var _=Me(),E=ce(_);Se(E,{position:new f(0,5,-10)});var C=q(E,2);ge(C,{direction:new f(0,1,0),intensity:.7});var z=q(C,2),y=ue(()=>{var d,p,M,T;return{...r().options,orientation:(d=r().options)!=null&&d.orientation?new f((p=r().options)==null?void 0:p.orientation.x,(M=r().options)==null?void 0:M.orientation.y,(T=r().options)==null?void 0:T.orientation.z):void 0}});N(z,{get options(){return pe(y)},get position(){return r().position},get rotation(){return r().rotation},get scaling(){return r().scaling}}),oe(c,_)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0},parameters:{__svelteCsf:{rawCode:`<Canvas style="width: 100%;">
  <Engine>
    <Scene>
      <FreeCamera position={new Vector3(0, 5, -10)} />
      <HemisphericLight direction={new Vector3(0, 1, 0)} intensity={0.7} />
      <Capsule
        options={{
          ...args.options,
          orientation: args.options?.orientation
            ? new Vector3(
                args.options?.orientation.x,
                args.options?.orientation.y,
                args.options?.orientation.z
              )
            : undefined
        }}
        position={args.position}
        rotation={args.rotation}
        scaling={args.scaling}
      />
    </Scene>
  </Engine>
</Canvas>`}}}),Q()}te.__docgen={version:3,name:"Capsule.stories.svelte",data:[],computed:[],methods:[],components:[],description:null,keywords:[],events:[],slots:[],refs:[]};const Te=me(te,ke),De=["Docs"],$e=Te.Docs;export{$e as Docs,De as __namedExportsOrder,ke as default};
